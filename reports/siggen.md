# Tap Impulse Generation

Tap impulses are generated by driving the LRA using a parametrised PWM-based excitation signal. The impulse is fully defined by three parameters: **frequency**, **amplitude**, and **duration**.

![PWM Signal](../docs/siggen.png)

---

## Parameters

### Amplitude

* Defines the effective drive amplitude applied to the LRA.
* As the microcontroller cannot output a true analog voltage, amplitude control is implemented using **PWM (Pulse Width Modulation)**.
* The user-facing amplitude parameter is normalised to the range **0–1**.
* Internally, this value maps to a **PWM duty cycle of 0–50%**, ensuring the actuator remains within its safe operating voltage range.

---

### Frequency

* Defines the excitation frequency (in **Hz**) of the signal driving the LRA.
* Vibration strength increases as the excitation frequency approaches the LRA’s mechanical resonance (≈ **230 Hz**).
* Frequencies far from resonance result in significantly reduced vibration amplitude due to the LRA’s band-pass mechanical response.

---

### Duration

* Defines the length of the impulse in **milliseconds**.
* The actuator is driven continuously at the specified frequency and amplitude for the duration of the impulse.

![LRA band-pass response](../docs/lrabp.png)

---

## Parameter Encoding

Each parameter is encoded using **1 byte (8 bits)**, allowing compact transmission and deterministic decoding:

* **Frequency:**

  * Range: **0–255 Hz**
  * Resolution: **1 Hz per step**

* **Amplitude:**

  * Range: **0–1 (normalised)**
  * Resolution: **1 / 255 ≈ 0.00392 per step**

* **Duration:**

  * Range: **0–255 ms**
  * Resolution: **1 ms per step**

